# Used to get information from Duo Devices:
# How to pass logs into logstash â””â”€$ cat /tmp/devices.csv| nc -q0 localhost 50000
# skip_header will ignore 1st line of the csv folder 

input {
    udp {
      port => 50001
      tags => ["duo-devices"]
    }   
}

filter {
  if "duo-devices" in [tags] {
   csv {
    separator => "," 
    skip_header => "true"
    columns => ["Username", "Phone Number", "Type", "Platform"]
    remove_field => ["message"]
        
    mutate {
      gsub => ["Phone Number", "\+", "" ]
    }   

    convert => { "Phone Number" => "integer" }
   }   
}
}


output {
  if "duo-devices" in [tags] {
    # hosts => "elasticsearch:9200"
    # user => "logstash_internal"
    # password => "${LOGSTASH_INTERNAL_PASSWORD}"
    # index => "duo-devices-logs-%{+YYYY.MM.dd}"
  stdout { codec => rubydebug }
  }
}

